/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var t={"./app/controller/index.js":(t,e,i)=>{i.r(e),i.d(e,{default:()=>h});var s=i("./app/controller/input.js");class h{constructor(){this.up=new s.default,this.left=new s.default,this.right=new s.default}keyDownUp(t,e){let i="keydown"==t;switch(e){case 37:this.left.getInput(i);break;case 38:this.up.getInput(i);break;case 39:this.right.getInput(i)}}}},"./app/controller/input.js":(t,e,i)=>{i.r(e),i.d(e,{default:()=>s});class s{constructor(){this.down=!1,this.active=!1}getInput(t){this.down!=t&&(this.active=t),this.down=t}}},"./app/engine/index.js":(t,e,i)=>{i.r(e),i.d(e,{default:()=>s});class s{constructor(t,e,i){this.timeStep=t,this.update=e,this.render=i,this.updated=!1,this.time=null,this.extraTime=0,this.animationFrameRequest=null,this.engineLoop=t=>this.loop(t)}loop(t){for(this.animationFrameRequest=window.requestAnimationFrame(this.engineLoop),this.extraTime+=t-this.time,this.time=t,this.extraTime>=3*this.timeStep&&(this.extraTime=this.timeStep);this.extraTime>=this.timeStep;)this.extraTime-=this.timeStep,this.update(this.timeStamp),this.updated=!0;this.updated&&(this.updated=!1,this.render(this.timeStamp))}start(){this.extraTime=this.timeStep,this.time=window.performance.now(),this.animationFrameRequest=window.requestAnimationFrame(this.engineLoop)}stop(){window.cancelAnimationFrame(this.animationFrameRequest)}}},"./app/game/animator.js":(t,e,i)=>{i.r(e),i.d(e,{default:()=>s});class s{constructor(t,e=4){this.count=0,this.delay=e>=1?e:1,this.frameSet=t,this.frameIndex=0,this.frameValue=t[0]}animate(){this.loop()}changeFrameSet(t,e=4,i=0){this.frameSet!==t&&(this.count=0,this.delay=e,this.frameSet=t,this.frameIndex=i,this.frameValue=t[i])}loop(){for(this.count++;this.count>this.delay;)this.count-=this.delay,this.frameIndex=this.frameIndex<this.frameSet.length-1?this.frameIndex+1:0,this.frameValue=this.frameSet[this.frameIndex]}}},"./app/game/collider.js":(t,e,i)=>{i.r(e),i.d(e,{default:()=>s});class s{collide(t,e,i,s,h){const a=t=>{switch(t){case"t":return this.collidePlatformTop(e,s);case"b":return this.collidePlatformBottom(e,s+h);case"l":return this.collidePlatformLeft(e,i);case"r":return this.collidePlatformRight(e,i+h)}};if("string"==typeof t){const e=t.split("");let i=!1;for(let t=0;t<e.length&&(i=a(e[t]),!i);t++);}}collidePlatformBottom(t,e){return t.getTop()<e&&t.getOldTop()>=e&&(t.setTop(e),t.velocityY=0,!0)}collidePlatformLeft(t,e){return t.getRight()>e&&t.getOldRight()<=e&&(t.setRight(e-.01),t.velocityX=0,!0)}collidePlatformRight(t,e){return t.getLeft()<e&&t.getOldLeft()>=e&&(t.setLeft(e),t.velocityX=0,!0)}collidePlatformTop(t,e){return t.getBottom()>e&&t.getOldBottom()<=e&&(t.setBottom(e-.01),t.velocityY=0,t.jumping=!1,!0)}}},"./app/game/index.js":(t,e,i)=>{i.r(e),i.d(e,{default:()=>h});var s=i("./app/game/world.js");class h{constructor(){this.world=new s.default}update(){this.world.update()}}},"./app/game/object.js":(t,e,i)=>{i.r(e),i.d(e,{default:()=>s});class s{constructor(t,e,i,s){this.height=s,this.width=i,this.x=t,this.xOld=t,this.y=e,this.yOld=e}getBottom(){return this.y+this.height}getLeft(){return this.x}getRight(){return this.x+this.width}getTop(){return this.y}getOldBottom(){return this.yOld+this.height}getOldLeft(){return this.xOld}getOldRight(){return this.xOld+this.width}getOldTop(){return this.yOld}setBottom(t){this.y=t-this.height}setLeft(t){this.x=t}setRight(t){this.x=t-this.width}setTop(t){this.y=t}setOldBottom(t){this.yOld=t-this.height}setOldLeft(t){this.xOld=t}setOldRight(t){this.xOld=t-this.width}setOldTop(t){this.yOld=t}}},"./app/game/player.js":(t,e,i)=>{i.r(e),i.d(e,{default:()=>a});var s=i("./app/game/object.js"),h=i("./app/game/animator.js");class a extends s.default{constructor(t,e){super(50,100,12,12),this.color="#ff0000",this.jumping=!0,this.velocityX=0,this.velocityY=0,this.direction=1;this.frameSets={},[{id:"Run",count:8},{id:"Jump",count:8},{id:"Idle",count:10}].forEach((({id:t,count:e})=>{for(let i=1;i<=e;i++){const e=new Image,s=new Image;e.src=`./sprites/player/left/${t} (${i}).png`,s.src=`./sprites/player/right/${t} (${i}).png`;const h=`${t.toLowerCase()}Left`,a=`${t.toLowerCase()}Right`,o=(t,e)=>{this.frameSets[t]||(this.frameSets[t]=[]),this.frameSets[t].push(e)};o(h,e),o(a,s)}})),this.animator=new h.default(this.frameSets.idleRight)}jump(){this.jumping||(this.jumping=!0,this.velocityY-=18)}moveLeft(){this.direction=-1,this.velocityX-=.5}moveRight(){this.direction=1,this.velocityX+=.5}updateAnimation(){this.velocityY<0?this.direction<0?this.animator.changeFrameSet(this.frameSets.jumpLeft,2):this.animator.changeFrameSet(this.frameSets.jumpRight,2):this.direction<0?this.velocityX<-.1?this.animator.changeFrameSet(this.frameSets.runLeft):this.animator.changeFrameSet(this.frameSets.idleLeft):this.direction>0&&(this.velocityX>.1?this.animator.changeFrameSet(this.frameSets.runRight):this.animator.changeFrameSet(this.frameSets.idleRight)),this.animator.animate()}update(t,e){this.xOld=this.x,this.yOld=this.y,this.velocityY+=t,this.x+=this.velocityX,this.y+=this.velocityY,this.velocityX*=e,this.velocityY*=e}}},"./app/game/world.js":(t,e,i)=>{i.r(e),i.d(e,{default:()=>a});var s=i("./app/game/player.js"),h=i("./app/game/collider.js");class a{constructor(t=.92,e=3){this.friction=t,this.gravity=e,this.rows=12,this.columns=16,this.tileSize=16,this.map=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[2,2,2,3,0,0,0,0,0,13,15,0,0,0,0,0],[9,9,9,16,0,0,0,0,0,0,0,0,0,1,2,2],[0,0,0,0,0,0,13,15,0,0,0,0,0,4,5,5],[0,0,0,0,0,0,0,0,0,0,0,0,0,12,9,9],[0,0,0,13,14,15,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,1,2,3,0,0,0,0,0,0],[0,0,0,0,0,0,0,4,5,6,0,0,0,0,0,0],[2,3,0,0,0,0,1,2,2,2,2,3,0,0,0,0],[2,2,2,3,17,17,4,5,5,5,5,10,2,3,17,17],[5,5,5,6,18,18,4,5,5,5,5,5,5,6,18,18]],this.collisonMap=[["","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","",""],["t","t","t","tr","","","","","","t","t","","","","",""],["","","","","r","","","","","","","","","lt","t","t"],["","","","","r","","t","t","","","","","","l","",""],["","","","","","","","","","","","","","l","",""],["","","","t","t","t","","","","","","","","","",""],["","","","","","","","t","t","t","","","","","",""],["","","","","","","","","","","","","","","",""],["t","t","","","","","tl","t","t","t","t","tr","","","",""],["tb","tb","tb","tr","","","l","","","","","","t","tr","",""],["","","","rt","lb","rb","l","","","","","","","r","",""]],this.height=this.tileSize*this.rows,this.width=this.tileSize*this.columns,this.player=new s.default,this.collider=new h.default}collideObject(t){let e,i,s,h,a;t.getLeft()<0?(t.setLeft(0),t.velocityX=0):t.getRight()>this.width&&(t.setRight(this.width),t.velocityX=0),t.getTop()<0?(t.setTop(0),t.velocityY=0):t.getBottom()-1>this.height&&(t.setBottom(this.height),t.velocityY=0,t.jumping=!1),h=Math.floor(t.getTop()/this.tileSize),i=Math.floor(t.getLeft()/this.tileSize),a=this.collisonMap[h][i],this.collider.collide(a,t,i*this.tileSize,h*this.tileSize,this.tileSize),h=Math.floor(t.getTop()/this.tileSize),s=Math.floor(t.getRight()/this.tileSize),a=this.collisonMap[h][s],this.collider.collide(a,t,s*this.tileSize,h*this.tileSize,this.tileSize),e=Math.floor((t.getBottom()-.01)/this.tileSize),i=Math.floor(t.getLeft()/this.tileSize),a=this.collisonMap[e][i],this.collider.collide(a,t,i*this.tileSize,e*this.tileSize,this.tileSize),e=Math.floor((t.getBottom()-.01)/this.tileSize),s=Math.floor(t.getRight()/this.tileSize),a=this.collisonMap[e][s],this.collider.collide(a,t,s*this.tileSize,e*this.tileSize,this.tileSize)}update(){this.player.update(this.gravity,this.friction),this.collideObject(this.player),this.player.updateAnimation()}}},"./app/index.js":(t,e,i)=>{i.r(e);var s=i("./app/game/index.js"),h=i("./app/screen/index.js"),a=i("./app/engine/index.js"),o=i("./app/controller/index.js");window.addEventListener("load",(function(){const t=new o.default,e=new s.default,i=new h.default(document.querySelector("canvas"));i.buffer.canvas.height=e.world.height,i.buffer.canvas.width=e.world.width;const r=()=>{i.resize(document.documentElement.clientWidth-32,document.documentElement.clientHeight-32,e.world.height/e.world.width),i.render()};r();new a.default(1e3/30,(()=>{t.left.active&&e.world.player.moveLeft(),t.right.active&&e.world.player.moveRight(),t.up.active&&(e.world.player.jump(),t.up.active=!1),e.update()}),(()=>{i.drawBackground(),i.drawMap(e.world.map);const{direction:t}=e.world.player;i.drawPlayer(e.world.player.animator.frameValue,e.world.player.getLeft(),e.world.player.getTop(),60,40,t<0?-32:-16,-24),i.render()})).start();const l=({type:e,keyCode:i})=>{t.keyDownUp(e,i)};window.addEventListener("keydown",l),window.addEventListener("keyup",l),window.addEventListener("resize",r)}))},"./app/screen/index.js":(t,e,i)=>{i.r(e),i.d(e,{default:()=>h});var s=i("./app/screen/tileset.js");class h{constructor(t){this.buffer=document.createElement("canvas").getContext("2d"),this.context=t.getContext("2d"),this.tileSet=new s.default(16,8)}drawMap(t){const{images:e,tileSize:i}=this.tileSet;for(let s=0;s<t.length;s++){const h=t[s];for(let t=0;t<h.length;t++){const a=h[t];if(a){const h=e[a];let o=t*i,r=s*i;this.buffer.drawImage(h,o,r,i,i)}}}}drawMapObjects(t){const{objectImages:e,tileSize:i}=this.tileSet;for(let s=0;s<t.length;s++){const h=t[s];for(let t=0;t<h.length;t++){const a=h[t];a&&a.forEach((h=>{const{id:a,xOffset:o=0,yOffset:r=0,width:l=16,height:n=16}=h,d=e[a];let c=t*i,m=s*i;this.buffer.drawImage(d,c+o,m+r,l,n)}))}}}drawBackground(){this.buffer.drawImage(this.tileSet.tileBackground,0,0,this.buffer.canvas.width,this.buffer.canvas.height)}drawPlayer(t,e,i,s,h,a,o){this.buffer.drawImage(t,e+a,i+o,s,h)}resize(t,e,i){e/t>i?(this.context.canvas.height=t*i,this.context.canvas.width=t):(this.context.canvas.height=e,this.context.canvas.width=e/i),this.context.webkitImageSmoothingEnabled=!1,this.context.mozImageSmoothingEnabled=!1,this.context.imageSmoothingEnabled=!1}render(){this.context.drawImage(this.buffer.canvas,0,0,this.buffer.canvas.width,this.buffer.canvas.height,0,0,this.context.canvas.width,this.context.canvas.height)}}},"./app/screen/tileset.js":(t,e,i)=>{i.r(e),i.d(e,{default:()=>s});class s{constructor(t,e){this.columns=e,this.tileSize=t,this.images=[],this.images.push(null),this.tileBackground=new Image;for(let t=1;t<=18;t++){const e=new Image;e.src=`./sprites/world-2/tiles/${t}.png`,this.images.push(e)}this.tileBackground.src="./sprites/world-2/bg.png"}}}},e={};function i(s){if(e[s])return e[s].exports;var h=e[s]={exports:{}};return t[s](h,h.exports,i),h.exports}i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i("./app/index.js")})();
//# sourceMappingURL=bundle.js.map